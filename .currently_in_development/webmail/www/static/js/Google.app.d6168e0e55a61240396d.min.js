webpackJsonp([7],{293:function(e,t,o){"use strict";e.exports=function(e){var t=o(2),n=o(185),c=o(182),s=o(294),i=c.getUserRole()===Enums.UserRole.SuperAdmin,a=c.getUserRole()===Enums.UserRole.NormalUser;return s.init(e),i?{start:function(e){e.run("AdminPanelWebclient","registerAdminPanelTab",[function(e){o.e(1,function(){e(o(296))})},s.HashModuleName,n.i18n("GOOGLE/LABEL_SETTINGS_TAB")])}}:a&&s.EnableModule&&t.isArray(s.Scopes)&&s.Scopes.length>0?{start:function(e){e.run("SettingsWebclient","registerSettingsTab",[function(){return o(295)},s.HashModuleName,n.i18n("GOOGLE/LABEL_SETTINGS_TAB")])}}:null}},294:function(e,t,o){"use strict";var n=o(2),c=o(44),s=o(181);e.exports={ServerModuleName:"Google",HashModuleName:"google",Connected:!1,EnableModule:!1,Id:"",Secret:"",Key:"",Scopes:[],init:function(e){var t=n.extend({},e[this.ServerModuleName]||{},e.Google||{});n.isEmpty(t)||(this.Connected=s.pBool(t.Connected,this.Connected),this.EnableModule=s.pBool(t.EnableModule,this.EnableModule),this.Id=s.pString(t.Id,this.Id),this.Secret=s.pString(t.Secret,this.Secret),this.Key=s.pString(t.Key,this.Key),this.Scopes=s.pArray(t.Scopes,this.Scopes))},getScopesCopy:function(){var e=[];return n.each(this.Scopes,function(t){e.push({Description:t.Description,Name:t.Name,Value:c.observable(t.Value)})}),e},updateScopes:function(e,t){var o=[];n.each(t,function(e){o.push({Description:e.Description,Name:e.Name,Value:e.Value()})}),this.Connected=e,this.Scopes=o},updateAdmin:function(e,t,o,n,c){this.EnableModule=e,this.Id=t,this.Secret=o,this.Key=n,this.Scopes=c}}},295:function(e,t,o){"use strict";function n(){S.call(this,g.ServerModuleName),this.connected=i.observable(g.Connected),this.scopes=i.observable(g.getScopesCopy()),this.bRunCallback=!1,window.googleConnectCallback=c.bind(function(e,t,o){this.bRunCallback=!0,e?(this.connected(!0),this.updateSavedState(),g.updateScopes(this.connected(),this.scopes())):l.showErrorByCode({ErrorCode:a.pInt(t),Module:o},"",!0)},this)}var c=o(2),s=o(1),i=o(44),a=o(181),r=o(179),u=o(191),l=o(186),p=o(182),h=o(42),d=o(200),S=h.run("SettingsWebclient","getAbstractSettingsFormViewClass"),g=o(294);c.extendOwn(n.prototype,S.prototype),n.prototype.ViewTemplate="Google_GoogleSettingsFormView",n.prototype.getCurrentValues=function(){var e=c.map(this.scopes(),function(e){return e.Name+e.Value()});return[this.connected(),e]},n.prototype.revertGlobalValues=function(){this.connected(g.Connected),this.scopes(g.getScopesCopy())},n.prototype.checkAndConnect=function(){var e={Scopes:[],Service:"google",AllowConnect:!0},t=c.find(this.scopes(),function(e){return"auth"===e.Name}),o=!!t&&!!t.Value(),n=c.find(g.getScopesCopy(),function(e){return"auth"===e.Name}),s=!!n&&!!n.Value();c.each(this.scopes(),function(t){t.Value()&&e.Scopes.push(t.Name)}),p.broadcastEvent("OAuthAccountChange::before",e),e.AllowConnect&&(o||o===s||!o&&p.isAccountDeletingAvailable())&&this.connect(e.Scopes)},n.prototype.connect=function(e){s.removeCookie("oauth-scopes"),s.cookie("oauth-scopes",e.join("|")),s.cookie("oauth-redirect","connect"),this.bRunCallback=!1;var t=d.open(r.getAppPath()+"?oauth=google","Google"),o=setInterval(c.bind(function(){t.closed&&(this.bRunCallback?(clearInterval(o),p.broadcastEvent("OAuthAccountChange::after"),this.updateSavedState(),g.updateScopes(this.connected(),this.scopes())):window.location.reload())},this),1e3)},n.prototype.checkAndDisconnect=function(){var e={Service:"google",AllowDisconnect:!0},t=c.find(g.getScopesCopy(),function(e){return"auth"===e.Name}),o=!!t&&!!t.Value();p.broadcastEvent("OAuthAccountChange::before",e),!e.AllowDisconnect||o&&!p.isAccountDeletingAvailable()||this.disconnect()},n.prototype.disconnect=function(){u.send(g.ServerModuleName,"DeleteAccount",null,function(e){e.Result?(this.connected(!1),c.each(this.scopes(),function(e){e.Value(!1)}),p.broadcastEvent("OAuthAccountChange::after"),this.updateSavedState(),g.updateScopes(this.connected(),this.scopes())):l.showErrorByCode(e,"",!0)},this)},e.exports=new n}});