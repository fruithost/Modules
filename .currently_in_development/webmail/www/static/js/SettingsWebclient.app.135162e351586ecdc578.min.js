webpackJsonp([20],{268:function(e,t,i){function s(e){this.sName="",this.visible=n.observable(!0),this.baseHash=n.observable(""),this.hash=n.observable(""),this.linkText=n.observable(e),this.isCurrent=n.observable(!1),this.recivedAnim=n.observable(!1).extend({autoResetToFalse:500}),this.unseenCount=n.observable(0),this.allowChangeTitle=n.observable(!1),this.inactiveTitle=n.observable(""),this.excludedHashes=n.observableArray([])}var n=i(44),a=i(195);s.prototype.ViewTemplate="CoreWebclient_HeaderItemView",s.prototype.setName=function(e){this.sName=e.toLowerCase(),""===this.baseHash()?(this.hash(a.buildHashFromArray([e.toLowerCase()])),this.baseHash(this.hash())):this.hash(this.baseHash())},e.exports=s},405:function(e,t,i){"use strict";e.exports=function(e){var t=i(182),s=t.getUserRole()===Enums.UserRole.SuperAdmin,n=t.getUserRole()===Enums.UserRole.NormalUser,a=t.getUserRole()===Enums.UserRole.Customer,r=null;if(s||n||a){var o=i(406);if(o.init(e),s)return{getAbstractSettingsFormViewClass:function(){return i(407)}};if(n||a)return{getScreens:function(){var e={};return e[o.HashModuleName]=function(){return i(408)},e},getHeaderItem:function(){if(null===r){var e=i(185),t=i(268);r=new t(e.i18n("COREWEBCLIENT/HEADING_SETTINGS_TABNAME"))}return{item:r,name:o.HashModuleName}},registerSettingsTab:function(e,t,s){var n=i(408);n.registerTab(e,t,s)},registerSettingsTabSection:function(e,t,s){var n=i(408);n.registerTabSection(e,t,s)},getAbstractSettingsFormViewClass:function(){return i(407)},setAddHash:function(e){var t=i(408);t.setAddHash(e)}}}return null}},406:function(e,t,i){"use strict";var s=i(2),n=i(181);e.exports={HashModuleName:"settings",TabsOrder:["common","mail","mail-accounts","contacts","calendar","files","mobilesync","outlooksync","helpdesk","openpgp"],init:function(e){var t=e.SettingsWebclient;s.isEmpty(t)||(this.TabsOrder=n.pArray(t.TabsOrder,this.TabsOrder))}}},407:function(e,t,i){"use strict";function s(e){this.sServerModule=e?e:"Core",this.isSaving=a.observable(!1),this.visible=a.observable(!0),this.sSavedState="",this.bShown=!1,this.SettingsTabName="",this.SettingsTabTitle="",this.aSettingsSections=[]}var n=i(2),a=i(44),r=i(185),o=i(191),h=i(186),u=i(188),c=i(192),v=i(201);s.prototype.ViewTemplate="",s.prototype.addSettingsSection=function(e){this.aSettingsSections.push(e)},s.prototype.showTab=function(e){this.bShown=!0,this.revert(),n.isFunction(this.onShow)&&this.onShow(e),n.each(this.aSettingsSections,function(t){n.isFunction(t.onShow)&&t.onShow(e)})},s.prototype.hasUnsavedChanges=function(){var e=this.getCurrentState()!==this.sSavedState;return n.each(this.aSettingsSections,function(t){n.isFunction(t.getCurrentState)&&(e=e||t.getCurrentState()!==t.sSavedState)}),e},s.prototype.hide=function(e,t){this.hasUnsavedChanges()?c.showPopup(v,[r.i18n("COREWEBCLIENT/CONFIRM_DISCARD_CHANGES"),n.bind(function(i){i?(this.bShown=!1,e(),this.revert()):n.isFunction(t)&&t()},this)]):(this.bShown=!1,e())},s.prototype.getCurrentValues=function(){return[]},s.prototype.getCurrentState=function(){var e=this.getCurrentValues();return e.join(":")},s.prototype.updateSavedState=function(){this.sSavedState=this.getCurrentState()},s.prototype.revertGlobalValues=function(){},s.prototype.revert=function(){n.each(this.aSettingsSections,function(e){n.isFunction(e.revert)&&e.revert()}),this.revertGlobalValues(),this.updateSavedState()},s.prototype.getParametersForSave=function(){return{}},s.prototype.save=function(){n.isFunction(this.validateBeforeSave)&&!this.validateBeforeSave()||(this.isSaving(!0),o.send(this.sServerModule,"UpdateSettings",this.getParametersForSave(),this.onResponse,this))},s.prototype.applySavedValues=function(e){},s.prototype.onResponse=function(e,t){if(this.isSaving(!1),e.Result){var i=t.Parameters;this.updateSavedState(),this.applySavedValues(i),u.showReport(r.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS"))}else h.showErrorByCode(e,r.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED"))},s.prototype.setAccessLevel=function(e,t){},e.exports=s},408:function(e,t,i){"use strict";function s(){u.call(this,"SettingsWebclient"),this.tabs=r.observableArray([]),this.currentTab=r.observable(null),o.subscribeEvent("OpenSettingTab",n.bind(function(e){this.changeTab(e.Name)},this)),o.broadcastEvent("SettingsWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this})}var n=i(2),a=i(1),r=i(44),o=i(182),h=i(195),u=i(198),c=i(406),v=a("html");n.extendOwn(s.prototype,u.prototype),s.prototype.ViewTemplate="SettingsWebclient_SettingsView",s.prototype.ViewConstructorName="CSettingsView",s.prototype.registerTab=function(e,t,i){var s=c.TabsOrder.length,a=e(),r=n.findWhere(this.tabs(),{name:t});n.isEmpty(a)||(a.SettingsTabName=t,a.SettingsTabTitle=i,r&&(n.isArray(r.sections)&&(n.each(r.sections,function(e){a.addSettingsSection(e)}),delete r.sections),r.view=a)),r||this.tabs.push({view:a,name:t}),this.tabs(n.sortBy(this.tabs(),function(e){var t=n.indexOf(c.TabsOrder,e.name);return t!==-1?t:s}))},s.prototype.registerTabSection=function(e,t){var i=n.findWhere(this.tabs(),{name:t}),s=e();i?i.view.addSettingsSection(s):(this.registerTab(function(){return{visible:r.observable(!1)}},t,""),i=n.findWhere(this.tabs(),{name:t}),i&&(n.isArray(i.sections)||(i.sections=[]),i.sections.push(s)))},s.prototype.hasUnsavedChanges=function(){var e=this.currentTab();return e&&e.view&&n.isFunction(e.view.hasUnsavedChanges)&&e.view.hasUnsavedChanges()},s.prototype.discardChanges=function(){var e=this.currentTab();e&&e.view&&n.isFunction(e.view.revert)&&e.view.revert()},s.prototype.onShow=function(){v.addClass("non-adjustable")},s.prototype.onHide=function(){var e=this.currentTab();e&&n.isFunction(e.view.hide)&&e.view.hide(function(){},function(){}),v.removeClass("non-adjustable")},s.prototype.onRoute=function(e){var t=e.shift(),i=this.currentTab(),s=n.find(this.tabs(),function(e){return e.name===t}),a=function(){s&&(n.isFunction(s.view.showTab)&&s.view.showTab(e),this.currentTab(s),s.name!==t&&h.replaceHashDirectly([c.HashModuleName,s.name]))}.bind(this),r=n.bind(function(){i&&h.replaceHashDirectly([c.HashModuleName,i.name])},this),o=!0;return i&&t===i.name?void(n.isFunction(i.view.showTab)&&i.view.showTab(e)):(s&&s.view.visible&&!s.view.visible()&&(s=n.find(this.tabs(),function(e){return!e.view.visible||e.view.visible()})),s?i&&n.isFunction(i.view.hide)&&(i.view.hide(a,r),o=!1):i||(s=n.find(this.tabs(),function(e){return!e.view.visible||e.view.visible()})),void(o&&a()))},s.prototype.changeTab=function(e){h.setHash([c.HashModuleName,e])},s.prototype.setAddHash=function(e){h.setHash(n.union([c.HashModuleName,this.currentTab()?this.currentTab().name:""],e))},e.exports=new s}});