(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{rIlC:function(i,e,n){"use strict";i.exports=function(i){var e=n("IAk5");if(e.isUserNormalOrTenant()){var s=n("F/us"),t=n("0h2I"),l=n("RN+F"),a=n("AFLV"),o=n("ZP6a"),d=n("o0Bx"),u=n("JFZZ"),r=n("SQrT"),c=!!i.MailZipWebclientPlugin&&!!i.MailZipWebclientPlugin.AllowZip;return{start:function(i){c&&(e.subscribeEvent("MailWebclient::ParseFile::after",(function(i){if(i&&s.isFunction(i.addAction)&&"zip"===i.extension()){i.mailzipSubFilesLoaded=t.observable(!1),i.mailzipSubFilesLoading=t.observable(!1),i.mailzipExpandFile=function(){this.mailzipSubFilesLoaded()||this.mailzipSubFilesLoading()?this.subFilesExpanded(!0):(this.mailzipSubFilesLoading(!0),d.send("MailZipWebclientPlugin","ExpandFile",{Hash:this.hash()},(function(e){var n=e.Result&&s.isArray(e.Result.Files)?e.Result.Files:[];this.mailzipSubFilesLoading(!1),this.subFiles([]),a.isNonEmptyArray(n)&&s.each(n,s.bind((function(e){var n=i.getNewInstance();n.parse(e),this.subFiles.push(n)}),this)),this.mailzipSubFilesLoaded(!0),this.subFilesExpanded(!0)}),this))};var e={Text:t.computed((function(){return this.subFilesExpanded()?l.i18n("COREWEBCLIENT/ACTION_COLLAPSE_FILE"):this.mailzipSubFilesLoading()?l.i18n("COREWEBCLIENT/INFO_LOADING"):l.i18n("COREWEBCLIENT/ACTION_EXPAND_FILE")}),i),Handler:s.bind((function(){this.mailzipSubFilesLoading()||(this.subFilesExpanded()?this.subFilesExpanded(!1):this.mailzipExpandFile())}),i)};i.addAction("expand",!0,e),i.removeAction("view")}})),e.subscribeEvent("MailWebclient::AddAllAttachmentsDownloadMethod",(function(i){i({Text:l.i18n("MAILZIPWEBCLIENTPLUGIN/ACTION_DOWNLOAD_ATTACHMENTS_ZIP"),Handler:function(i,e){r.showLoading(l.i18n("COREWEBCLIENT/INFO_LOADING")),d.send("MailZipWebclientPlugin","SaveAttachments",{AccountID:i,Attachments:e},(function(i){if(r.hideLoading(),i.Result&&i.Result.Actions&&i.Result.Actions.download){var e=i.Result.Actions.download.url;o.downloadByUrl(e)}else u.showErrorByCode(i)}))}})})))}}}return null}}}]);